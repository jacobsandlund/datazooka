<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Binfo</title>
    <link rel="stylesheet" type="text/css" href="binfo.css">

<style>

@import url(http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400,700);

body {
  font-family: "Helvetica Neue";
  margin: 40px auto;
  width: 960px;
  min-height: 2000px;
}

#body {
  position: relative;
}

footer {
  padding: 2em 0 1em 0;
  font-size: 12px;
}

h1 {
  font-size: 96px;
  margin-top: .3em;
  margin-bottom: 0;
}

h1 + h2 {
  margin-top: 0;
}

h2 {
  font-weight: 400;
  font-size: 28px;
}

h1, h2 {
  font-family: "Yanone Kaffeesatz";
  text-rendering: optimizeLegibility;
}

#body > p {
  line-height: 1.5em;
  width: 640px;
  text-rendering: optimizeLegibility;
}

</style>

  </head>

  <body>
  <div id="body">

    <h1>Binfo</h1>

    <h2>Multivariate Analysis Tool using Crossfilter and D3</h2>

    <p>
    This is the <a href="http://square.github.com/crossfilter/">Crossfilter's</a>
    home page demo generalized so you can more easily fit it to your data.
    </p>
    <p>
    I can't thank Mike Bostock (<a href="https://github.com/mbostock">mbostock</a>)
    enough for the awesome <a href="http://square.github.com/crossfilter/">Crossfilter</a>
    and <a href="http://d3js.org/">D3</a> libraries that this is built on.
    </p>
    <p> Test Links:
      <a href="#data=flights&charts=time,date&filters=">one</a>
      <a href="#data=flights&charts=time,delay,distance&filters=time*10*15,delay*0*100">two</a>
      <a href="#data=flights&charts=time,delay,distance&filters=time*10*15,delay*-60*0">three</a>
      <a href="#data=flights&charts=time,delay,distance&filters=time*8*20">four</a>
    </p>


    <div id="charts"></div>

    <footer>
      <span style="float:right;">
        Released under the <a href="http://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>.
      </span>
      Copyright 2012 Jake Sandlund, <a href="http://squareup.com">Square, Inc.</a>
    </footer>

  </div>
  <a href="https://github.com/jakesandlund/binfo"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png" alt="Fork me on GitHub"></a>
  </body>

  <script src="crossfilter.v1.min.js"></script>
  <script src="d3.v2.min.js"></script>
  <script src="binfo.js"></script>

<script>

setHolder('#charts');
renderFromHash() || renderCharts('flights', ['time', 'delay', 'distance']);

// (It's CSV, but GitHub Pages only gzip's JSON at the moment.)
d3.csv("flights-3m.json", function(flights) {

  // A little coercion, since the CSV is untyped.
  flights.forEach(function(d, i) {
    d.index = i;
    d.date = parseDate(d.date);
    d.delay = +d.delay;
    d.distance = +d.distance;
  });

  // Like d3.time.format, but faster.
  function parseDate(d) {
    return new Date(2001,
        d.substring(0, 2) - 1,
        d.substring(2, 4),
        d.substring(4, 6),
        d.substring(6, 8));
  }

  var charts = {
    time: {
      label: 'Time of Day',
      dimension: function(d) { return d.date.getHours() + d.date.getMinutes() / 60; },
      groupBy: 1
    },
    delay: {
      label: 'Arrival Delay (min.)',
      dimension: function(d) { return Math.max(-60, Math.min(149, d.delay)); },
      groupBy: 10
    },
    distance: {
      label: 'Distance (mi.)',
      dimension: function(d) { return Math.min(1999, d.distance); },
      groupBy: 50
    },
    date: {
      label: 'Date',
      dimension: function(d) { return d3.time.day(d.date); },
      round: d3.time.day.round,
      x: (d3.time.scale()
          .domain([new Date(2001, 0, 1), new Date(2001, 3, 1)])
          .range([0, 900]))
    }
  };
  dataSet('flights', charts, flights);
});

</script>

</html>

